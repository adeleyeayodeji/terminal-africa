!function(){"use strict";var e={n:function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,{a:a}),a},d:function(t,a){for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,a=window.React,n=window.ReactDOM,s=e.n(n),o=window.wp.components;class l extends a.Component{constructor(e){super(e)}state={};render(){return(0,t.createElement)("div",{className:"t-center",style:{padding:10}},(0,t.createElement)(o.Spinner,null),(0,t.createElement)("p",null,(0,t.createElement)("strong",null,"Loading...")))}}var r=l;class i extends a.Component{constructor(e){super(e),this.state={showModal:!1,closeModal:!1,value:"",addressBook:[],isLoading:!0,isLoadingNew:!1,scrolledToBottom:!1,defaultPage:1,nextPageisAvailable:!1}}componentDidMount(){}componentWillUnmount(){}getAddressBook=()=>{jQuery(document).ready((e=>{e.ajax({type:"GET",url:terminal_africa.ajax_url,data:{action:"terminal_africa_get_address_book",nonce:terminal_africa.nonce,page:this.state.defaultPage},dataType:"json",beforeSend:()=>{this.setState({isLoadingNew:!0})},success:e=>{var t=e.data.pagination.hasNextPage;t=Boolean(t),200===e.code?this.setState({addressBook:[...this.state.addressBook,...e.data.addresses],isLoading:!1,isLoadingNew:!1,nextPageisAvailable:t}):this.setState({isLoading:!1})},error:(e,t,a)=>{try{wp.data.dispatch("core/notices").createNotice("success","Error: "+e.responseText,{type:"snackbar",isDismissible:!0})}catch(a){}}})}))};handleScroll=e=>{const t=e.target;var a=t.scrollTop+t.clientHeight;(a=Math.ceil(a))>=t.scrollHeight?(this.setState({scrolledToBottom:!0,defaultPage:this.state.defaultPage+1}),this.state.nextPageisAvailable&&this.getAddressBook()):this.setState({scrolledToBottom:!1})};showModal=e=>{e.preventDefault(),this.setState({showModal:!0}),this.getAddressBook()};closeModal=()=>{this.setState({showModal:!1})};handleChange=e=>{this.setState({value:e})};handleItemClick=e=>{e.preventDefault();var t=e.currentTarget.getAttribute("data-address-id"),a=this.state.addressBook.find((e=>e.address_id===t));if(a)jQuery(document).ready((e=>{const t=e(".t-body");if(t.find('input[name="first_name"]').val(a.first_name),t.find('input[name="last_name"]').val(a.last_name),t.find('input[name="email"]').val(a.email),t.find('input[name="phone"]').val(a.phone),t.find('input[name="line_1"]').val(a.line1),t.find('input[name="line_2"]').val(a.line2),t.find('input[name="zip_code"]').val(a.zip),t.find('input[name="address_id"]').length)t.find('input[name="address_id"]').val(a.address_id);else{var n=e("<input>").attr("type","hidden").attr("name","address_id").val(a.address_id);t.find("form").append(e(n))}t.find('input[name="zip_code"]').val(a.zip),this.closeModal(),t.find('select[name="lga"] option').remove().trigger("select2.change");const s=t.find('select[name="country"]');s.val(a.country),s.trigger("change")}));else try{wp.data.dispatch("core/notices").createNotice("success","Address not found",{type:"snackbar",isDismissible:!0})}catch(e){}};render(){let{showModal:e,value:a,isLoading:n,addressBook:s,scrolledToBottom:l,isLoadingNew:i}=this.state;return(0,t.createElement)(t.Fragment,null,e&&(0,t.createElement)(o.Modal,{title:"Terminal Address Book",onRequestClose:this.closeModal},(0,t.createElement)("div",{className:"t-phonebook-modal"},(0,t.createElement)("div",{className:"t-phonebook-area"},(0,t.createElement)("div",{className:"t-input-container"},(0,t.createElement)(o.SearchControl,{label:"Search Address Book",placeholder:"Search Address Book",className:"t-phonebook-search",value:a,onChange:e=>this.handleChange(e)})),(0,t.createElement)("div",{className:"t-scroll-area"},(0,t.createElement)(o.__experimentalScrollable,{style:{maxHeight:200},smoothScroll:!0,onScroll:this.handleScroll,className:"t-scroll-area-div"},(0,t.createElement)("div",{style:{maxHeight:500}},n?(0,t.createElement)(r,null):(0,t.createElement)(t.Fragment,null,(0,t.createElement)(o.__experimentalItemGroup,null,s.map(((e,a)=>(0,t.createElement)(o.__experimentalItem,{key:a,className:"t-phonebook-item","data-address-id":e.address_id,onClick:this.handleItemClick},(0,t.createElement)("div",{className:"t-phonebook-item-content"},(0,t.createElement)("div",{className:"t-phonebook-item-name"},e.city,", ",e.state,", ",e.country),(0,t.createElement)("div",{className:"t-phonebook-item-phone"},e.line1)))))),l&&(0,t.createElement)("div",{className:"t-phonebook-scrolled-to-bottom-message"},i?(0,t.createElement)(r,null):(0,t.createElement)(t.Fragment,null,"You've reached the end of the list."))))))))),(0,t.createElement)("button",{className:"t-phonebook",onClick:this.showModal},(0,t.createElement)("i",{className:"fa fa-address-book",ariaHidden:"true"})," Import Address"))}}var d=i;document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("t-phonebook-container");e&&s().render((0,t.createElement)(d,null),e)}))}();